import{J as k,r as g,x as G,j as e,Q as V,t as I}from"./app-DRrHojaG.js";import{C as o}from"./CustomInput-DV5YoaUn.js";import{C as W,a as B,S as X}from"./Customselect-BYAimMjC.js";import{B as Y}from"./button-BuJzaNID.js";import{F as E,C as x,a as h,b as u,d as y,c as v}from"./card-DOr82eaN.js";import{B as Z}from"./badge-zR9X7Ung.js";import{S as ee}from"./separator-C-4gOJsk.js";import{I as d}from"./icon-9PIIoNm_.js";import{I as se}from"./input-CjzGAmC8.js";import{A as ae}from"./app-layout-jSz2uPLn.js";import{C as te,a as re}from"./CustomtextArea-s-14ojIi.js";import{C as ie}from"./Custommodal-Bijt5Y-c.js";import{u as ce}from"./useTranslation-DZairWB1.js";import{A as ne}from"./arrow-left-CSajb_FD.js";import{U as K}from"./user-_6XEYKMa.js";import{R as le}from"./receipt-DXEaXDmv.js";import{C as oe}from"./car-BTvP5E4W.js";import{S as de}from"./save-DaJ3FWZK.js";/* empty css            */import"./label-CUFgRLfr.js";import"./index-C8Gpbpq8.js";import"./building-BQtN6JYq.js";import"./index-DDCA5pFv.js";import"./app-logo-icon-B5qPAw4t.js";import"./circle-check-big-DJ0PYvcw.js";function Ue({invoice:i}){const{invoicetypes:L}=k().props,[p,N]=g.useState(null),[f,U]=g.useState(""),b=g.useRef(null),{t:a}=ce(),{services:$}=k().props,D=[{title:a("dashboard"),href:"/dashboard"},{title:a("show-invoices"),href:"/show/invoices"},{title:a("edit-invoice"),href:"#"}],P=s=>s?Array.isArray(s)?s.length>0&&typeof s[0]=="object"&&s[0].service?s:s.map(r=>({service:r,price:0})):[]:[],{data:t,setData:c,post:T,processing:_,errors:n}=G({invoice_type:i.invoice_type||"",payment_type:i.payment_type||"",client_id:i.client_id||"",client:i.client||"",phone:i.phone||"",address:i.address||"",price:i.price||"",vat:i.vat||15,car_no:i.car_no||"",car_type:i.car_type||"",percent:i.percent||"",service:P(i.service),invoice_date:i.invoice_date||"",client_vat_number:i.client_vat_number||"",note:i.note||""}),Q=s=>{s.preventDefault(),T(route("invoice.update.confirm",i.id),{onSuccess:()=>{b.current&&b.current.showModal()}})},C=s=>{N(s),c(r=>({...r,client_id:s.id.toString(),client:s.name,phone:s.phone||"",address:s.address||"",client_vat_number:s.client_vat_number||""}))},z=(s,r)=>{r?C(r):(N(null),c(l=>({...l,client_id:"",client:s})))},H=[{id:1,title:a("cash"),value:a("cash")},{id:2,title:a("visa"),value:a("visa")},{id:3,title:a("transfer"),value:a("transfer")}],w=t.service.reduce((s,r)=>s+(r.price||0),0),S=Number(t.price)||0,j=S+w,A=Number(t.vat)||0,R=j*A/100,J=j+R,M=s=>{t.service.find(l=>l.service===s)||c("service",[...t.service,{service:s,price:0}])},O=s=>{c("service",t.service.filter(r=>r.service!==s))},q=(s,r)=>{c("service",t.service.map(l=>l.service===s?{...l,price:r}:l))},F=$.filter(s=>s.type.toLowerCase().includes(f.toLowerCase()));return e.jsxs(ae,{breadcrumbs:D,children:[e.jsx(V,{title:`${a("edit-invoice")} #${i.invoice_number}`}),e.jsxs("div",{className:"flex justify-between items-center mb-6 px-6 pt-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-900 arabic-font",children:[a("edit-invoice")," #",i.invoice_number]}),e.jsx("p",{className:"text-gray-600 mt-1 arabic-font",children:a("edit-invoice-description")||"Update invoice information and details"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(I,{href:"/show/invoices",className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors arabic-font",children:[e.jsx(d,{iconNode:ne,className:"h-4 w-4"}),a("back-to-invoices")]}),e.jsxs(I,{href:"/invoice/create",className:"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors arabic-font",children:[e.jsx(d,{iconNode:E,className:"h-4 w-4"}),a("create-new")]})]})]}),e.jsx("div",{className:"px-6 pb-6",children:e.jsxs("form",{onSubmit:Q,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs(x,{className:"lg:col-span-2",children:[e.jsxs(h,{children:[e.jsxs(u,{className:"flex items-center gap-2 arabic-font",children:[e.jsx(d,{iconNode:K,className:"h-5 w-5 text-blue-600"}),a("client-information")]}),e.jsx(y,{className:"arabic-font",children:a("client-info-description")||"Update client information and details"})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsx(W,{value:t.client,onChange:z,onClientSelect:C,label:a("client-name"),placeholder:a("search-or-enter-client-name")||"Search for existing client or enter new name...",error:n.client}),p&&e.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(d,{iconNode:K,className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-800 arabic-font",children:a("existing-client-selected")||"Existing Client Selected"})]}),e.jsxs("div",{className:"text-sm text-blue-700 arabic-font",children:[e.jsx("p",{children:e.jsx("strong",{children:p.name})}),p.company_name&&e.jsx("p",{children:p.company_name})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(o,{label:a("phone"),type:"text",placeholder:a("phone"),value:t.phone,onChange:s=>c("phone",s.target.value),error:n.phone}),e.jsx(o,{label:a("client_vat_number"),type:"text",placeholder:a("client_vat_number"),value:t.client_vat_number,onChange:s=>c("client_vat_number",s.target.value),error:n.client_vat_number})]}),e.jsx(o,{label:a("address"),type:"text",placeholder:a("address"),value:t.address,onChange:s=>c("address",s.target.value),error:n.address})]})]}),e.jsxs(x,{children:[e.jsx(h,{children:e.jsxs(u,{className:"flex items-center gap-2 arabic-font",children:[e.jsx(d,{iconNode:te,className:"h-5 w-5 text-green-600"}),a("invoice-summary")]})}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 arabic-font",children:a("base-price")}),e.jsxs("span",{className:"font-medium arabic-font",children:[S.toFixed(2)," SAR"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 arabic-font",children:a("services-total")}),e.jsxs("span",{className:"font-medium arabic-font",children:[w.toFixed(2)," SAR"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 arabic-font",children:a("subtotal")}),e.jsxs("span",{className:"font-medium arabic-font",children:[j.toFixed(2)," SAR"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-gray-600 arabic-font",children:[a("vat")," (",A,"%)"]}),e.jsxs("span",{className:"font-medium arabic-font",children:[R.toFixed(2)," SAR"]})]}),e.jsx(ee,{}),e.jsxs("div",{className:"flex justify-between items-center text-lg font-bold",children:[e.jsx("span",{className:"arabic-font",children:a("total")}),e.jsxs("span",{className:"text-green-600 arabic-font",children:[J.toFixed(2)," SAR"]})]})]}),t.service.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2 arabic-font",children:a("selected-services")}),e.jsx("div",{className:"space-y-2",children:t.service.map((s,r)=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-sm arabic-font",children:s.service}),e.jsxs("span",{className:"text-sm font-medium arabic-font",children:[s.price.toFixed(2)," SAR"]})]},r))})]})]})]})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(u,{className:"flex items-center gap-2 arabic-font",children:[e.jsx(d,{iconNode:E,className:"h-5 w-5 text-purple-600"}),a("invoice-details")]}),e.jsx(y,{className:"arabic-font",children:a("invoice-details-description")||"Configure invoice settings and services"})]}),e.jsxs(v,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx(B,{label:a("select-invoice-type"),items:L,titleKey:"type",valueKey:"type",value:t.invoice_type,onChange:s=>c("invoice_type",s.target.value),error:n.invoice_type}),e.jsx(B,{label:a("select-payment-type"),items:H,value:t.payment_type,onChange:s=>c("payment_type",s.target.value),titleKey:"title",valueKey:"title",error:n.payment_type}),e.jsx(o,{label:a("invoice-date"),type:"date",value:t.invoice_date,onChange:s=>c("invoice_date",s.target.value),error:n.invoice_date})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(o,{label:a("price"),type:"number",step:"0.01",placeholder:a("price"),value:t.price,onChange:s=>c("price",s.target.value),error:n.price}),e.jsx(o,{label:a("vat-percentage"),type:"number",step:"0.01",placeholder:a("vat"),value:t.vat,onChange:s=>c("vat",s.target.value),error:n.vat})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 arabic-font",children:a("services")}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(X,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(se,{type:"text",placeholder:a("search-services")||"Search services...",value:f,onChange:s=>U(s.target.value),className:"pl-10 arabic-font"})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:F.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500 arabic-font",children:f?a("no-services-found")||"No services found matching your search":a("no-services-available")||"No services available"}):F.map(s=>{const r=t.service.some(m=>m.service===s.type),l=t.service.find(m=>m.service===s.type);return e.jsxs("div",{className:"border rounded-lg p-3 hover:border-blue-300 transition-colors",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:`service-${s.id}`,checked:r,onChange:m=>{m.target.checked?M(s.type):O(s.type)},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:`service-${s.id}`,className:"text-sm font-medium text-gray-700 arabic-font cursor-pointer",children:s.type})]})}),r&&e.jsx("div",{className:"mt-2",children:e.jsx(o,{label:a("service-price"),type:"number",step:"0.01",placeholder:a("enter-service-price"),value:(l==null?void 0:l.price)||0,onChange:m=>q(s.type,Number(m.target.value))})})]},s.id)})}),t.service.length>0&&e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(d,{iconNode:le,className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"text-sm font-medium text-blue-800 arabic-font",children:[a("selected-services-count",{count:t.service.length})," (",t.service.length,")"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.service.map((s,r)=>e.jsxs(Z,{variant:"secondary",className:"arabic-font",children:[s.service,": ",s.price.toFixed(2)," SAR"]},r))})]}),n.service&&e.jsx("p",{className:"mt-1 text-sm text-red-600 arabic-font",children:n.service})]})})]})]}),e.jsxs(x,{children:[e.jsxs(h,{children:[e.jsxs(u,{className:"flex items-center gap-2 arabic-font",children:[e.jsx(d,{iconNode:oe,className:"h-5 w-5 text-orange-600"}),a("additional-details")]}),e.jsx(y,{className:"arabic-font",children:a("additional-details-description")||"Optional vehicle and additional information"})]}),e.jsxs(v,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx(o,{label:a("car_no"),type:"text",placeholder:a("car_no"),value:t.car_no,onChange:s=>c("car_no",s.target.value),error:n.car_no}),e.jsx(o,{label:a("car_type"),type:"text",placeholder:a("car_type"),value:t.car_type,onChange:s=>c("car_type",s.target.value),error:n.car_type}),e.jsx(o,{label:a("percent"),type:"number",step:"0.01",placeholder:a("percent"),value:t.percent,onChange:s=>c("percent",s.target.value),error:n.percent})]}),e.jsx(re,{label:a("note"),value:t.note,onChange:s=>c("note",s.target.value),error:n.note})]})]}),e.jsx("div",{className:"flex justify-center pt-6",children:e.jsxs(Y,{type:"submit",disabled:_,className:"px-8 py-3 text-lg arabic-font",size:"lg",children:[e.jsx(d,{iconNode:de,className:"h-5 w-5 mr-2"}),a(_?"updating":"update-invoice")]})})]})}),e.jsx(ie,{modalname:b,message:a("invoice-updated-successfully")})]})}export{Ue as default};
