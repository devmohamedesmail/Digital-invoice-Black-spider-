import{r,j as e}from"./app-DRrHojaG.js";import{C as y,c as w}from"./card-DOr82eaN.js";import{I as _}from"./input-CjzGAmC8.js";import{L as R}from"./label-CUFgRLfr.js";import{a as D}from"./button-BuJzaNID.js";import{B as E}from"./building-BQtN6JYq.js";import{U as T}from"./user-_6XEYKMa.js";import{u as L}from"./useTranslation-DZairWB1.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],B=D("Search",A);function P({value:m,onChange:u,onClientSelect:h,label:x="Client Name",placeholder:p="Search or enter client name...",error:c}){const[a,o]=r.useState([]),[n,l]=r.useState(!1),[b,g]=r.useState(!1),[f,i]=r.useState(-1),v=r.useRef(null);r.useRef(null);const d=r.useRef(null),C=async s=>{if(s.length<2){o([]),l(!1);return}g(!0);try{const N=await(await fetch(`/api/clients/search?search=${encodeURIComponent(s)}`)).json();o(N),l(N.length>0),i(-1)}catch(t){console.error("Error searching clients:",t),o([]),l(!1)}finally{g(!1)}},k=s=>{const t=s.target.value;u(t),d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{C(t)},300)},j=s=>{u(s.name,s),h(s),l(!1),o([]),i(-1)},S=s=>{if(!(!n||a.length===0))switch(s.key){case"ArrowDown":s.preventDefault(),i(t=>t<a.length-1?t+1:t);break;case"ArrowUp":s.preventDefault(),i(t=>t>0?t-1:t);break;case"Enter":s.preventDefault(),f>=0&&f<a.length&&j(a[f]);break;case"Escape":l(!1),i(-1);break}},I=()=>{setTimeout(()=>{l(!1),i(-1)},200)};return r.useEffect(()=>()=>{d.current&&clearTimeout(d.current)},[]),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(R,{className:"block text-sm font-medium text-gray-700 mb-2 arabic-font",children:x}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(_,{ref:v,type:"text",value:m,onChange:k,onKeyDown:S,onBlur:I,onFocus:()=>m.length>=2&&l(a.length>0),placeholder:p,className:`pl-10 arabic-font ${c?"border-red-500":""}`,autoComplete:"off"}),b&&e.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"})})]}),n&&a.length>0&&e.jsx(y,{className:"absolute z-50 w-full mt-1 max-h-64 overflow-y-auto shadow-lg border border-gray-200",children:e.jsx(w,{className:"p-0",children:a.map((s,t)=>e.jsx("div",{className:`p-3 cursor-pointer transition-colors hover:bg-gray-50 border-b border-gray-100 last:border-b-0 ${t===f?"bg-blue-50 border-blue-200":""}`,onClick:()=>j(s),children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:s.company_name?e.jsx(E,{className:"h-5 w-5 text-blue-600"}):e.jsx(T,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 arabic-font truncate",children:s.name}),s.company_name&&e.jsx("span",{className:"text-xs text-blue-600 bg-blue-100 px-2 py-1 rounded-full",children:s.company_name})]}),e.jsxs("div",{className:"mt-1 space-y-1",children:[s.phone&&e.jsxs("p",{className:"text-xs text-gray-600 arabic-font",children:["ðŸ“ž ",s.phone]}),s.email&&e.jsxs("p",{className:"text-xs text-gray-600 arabic-font",children:["ðŸ“§ ",s.email]}),s.client_vat_number&&e.jsxs("p",{className:"text-xs text-gray-600 arabic-font",children:["ðŸ¢ VAT: ",s.client_vat_number]})]})]})]})},s.id))})}),n&&a.length===0&&m.length>=2&&!b&&e.jsx(y,{className:"absolute z-50 w-full mt-1 shadow-lg border border-gray-200",children:e.jsx(w,{className:"p-4 text-center",children:e.jsx("p",{className:"text-sm text-gray-500 arabic-font",children:"No existing clients found. This will be saved as a new client."})})})]}),c&&e.jsx("p",{className:"mt-1 text-sm text-red-600 arabic-font",children:c})]})}function G({error:m,label:u,onChange:h,items:x,titleKey:p,valueKey:c}){const{t:a,i18n:o}=L();return e.jsxs("div",{className:"my-3",children:[e.jsx("label",{className:`block mb-1 text-xs ${o.language==="ar"?"text-right arabic-font":"text-left"}`,children:u}),e.jsxs("select",{defaultValue:"Pick a text editor",onChange:h,className:"select select-neutral focus:border-orange-600 h-12 focus:outline-0 w-full border ",children:[e.jsx("option",{children:a("select-payment-type")}),x&&x.map(n=>e.jsxs("option",{value:n[c],children:[" ",n[p]," "]},n[c]))]}),e.jsx("p",{className:"text-red-600 text-xs",children:m})]})}export{P as C,B as S,G as a};
