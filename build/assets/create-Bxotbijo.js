import{J as A,r as f,x as z,j as e,Q as H,t as J}from"./app-DRrHojaG.js";import{C as o}from"./CustomInput-DV5YoaUn.js";import{C as M,a as F,S as q}from"./Customselect-BYAimMjC.js";import{B as G}from"./button-BuJzaNID.js";import{C as p,a as x,b as v,d as g,c as h,F as V}from"./card-DOr82eaN.js";import{B as W}from"./badge-zR9X7Ung.js";import{S as X}from"./separator-C-4gOJsk.js";import{I as d}from"./icon-9PIIoNm_.js";import{I as Y}from"./input-CjzGAmC8.js";import{A as Z}from"./app-layout-jSz2uPLn.js";import{C as ee,a as se}from"./CustomtextArea-s-14ojIi.js";import{C as ae}from"./Custommodal-Bijt5Y-c.js";import{u as te}from"./useTranslation-DZairWB1.js";import{E as re}from"./eye-BYMBrEoA.js";import{U as E}from"./user-_6XEYKMa.js";import{R as ie}from"./receipt-DXEaXDmv.js";import{C as ce}from"./car-BTvP5E4W.js";import{S as ne}from"./save-DaJ3FWZK.js";/* empty css            */import"./label-CUFgRLfr.js";import"./index-C8Gpbpq8.js";import"./building-BQtN6JYq.js";import"./index-DDCA5pFv.js";import"./app-logo-icon-B5qPAw4t.js";import"./circle-check-big-DJ0PYvcw.js";function Be(){const{invoicetypes:I}=A().props,[m,j]=f.useState(null),[u,P]=f.useState(""),b=f.useRef(null),{t:a}=te(),{services:k}=A().props,B=[{title:a("dashboard"),href:"/dashboard"},{title:a("create-invoice"),href:"/invoice/create"}],{data:t,setData:i,post:D,processing:y,errors:c}=z({invoice_number:"",invoice_type:"",payment_type:"",client_id:"",client:"",phone:"",address:"",price:"",vat:15,car_no:"",car_type:"",percent:"",service:[],invoice_date:new Date().toISOString().split("T")[0],client_vat_number:"",note:""}),K=s=>{s.preventDefault();const r=t.service.reduce((n,l)=>n+(l.price||0),0);i("price",r.toString()),D(route("invoice.store"),{onSuccess:()=>{b.current&&b.current.showModal()}})},N=s=>{j(s),i(r=>({...r,client_id:s.id.toString(),client:s.name,phone:s.phone||"",address:s.address||"",client_vat_number:s.client_vat_number||""}))},T=(s,r)=>{r?N(r):(j(null),i(n=>({...n,client_id:"",client:s})))},L=[{id:1,title:a("cash"),value:a("cash")},{id:2,title:a("visa"),value:a("visa")},{id:3,title:a("transfer"),value:a("transfer")}],C=t.service.reduce((s,r)=>s+(r.price||0),0),_=C,S=Number(t.vat)||0,w=_*S/100,O=_+w,Q=s=>{t.service.find(n=>n.service===s)||i("service",[...t.service,{service:s,price:0}])},U=s=>{i("service",t.service.filter(r=>r.service!==s))},$=(s,r)=>{i("service",t.service.map(n=>n.service===s?{...n,price:r}:n))},R=k.filter(s=>s.type.toLowerCase().includes(u.toLowerCase()));return e.jsxs(Z,{breadcrumbs:B,children:[e.jsx(H,{title:a("create-invoice")}),e.jsxs("div",{className:"flex justify-between items-center mb-6 px-6 pt-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 arabic-font",children:a("create-invoice")}),e.jsx("p",{className:"text-gray-600 mt-1 arabic-font",children:a("create-new-invoice-description")||"Create a new invoice for your client"})]}),e.jsxs(J,{href:"/show/invoices",className:"flex items-center gap-2 px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors arabic-font",children:[e.jsx(d,{iconNode:re,className:"h-4 w-4"}),a("show-invoices")]})]}),e.jsx("div",{className:"px-6 pb-6",children:e.jsxs("form",{onSubmit:K,className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-6 lg:grid-cols-3",children:[e.jsxs(p,{className:"lg:col-span-2",children:[e.jsxs(x,{children:[e.jsxs(v,{className:"flex items-center gap-2 arabic-font",children:[e.jsx(d,{iconNode:E,className:"h-5 w-5 text-blue-600"}),a("client-information")]}),e.jsx(g,{className:"arabic-font",children:a("client-info-description")||"Search for existing client or enter new client details"})]}),e.jsxs(h,{className:"space-y-4",children:[e.jsx(M,{value:t.client,onChange:T,onClientSelect:N,label:a("client-name"),placeholder:a("search-or-enter-client-name")||"Search for existing client or enter new name...",error:c.client}),m&&e.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(d,{iconNode:E,className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-800 arabic-font",children:a("existing-client-selected")||"Existing Client Selected"})]}),e.jsxs("div",{className:"text-sm text-blue-700 arabic-font",children:[e.jsx("p",{children:e.jsx("strong",{children:m.name})}),m.company_name&&e.jsx("p",{children:m.company_name})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsx(o,{label:a("phone"),type:"text",placeholder:a("phone"),value:t.phone,onChange:s=>i("phone",s.target.value),error:c.phone}),e.jsx(o,{label:a("client_vat_number"),type:"text",placeholder:a("client_vat_number"),value:t.client_vat_number,onChange:s=>i("client_vat_number",s.target.value),error:c.client_vat_number})]}),e.jsx(o,{label:a("address"),type:"text",placeholder:a("address"),value:t.address,onChange:s=>i("address",s.target.value),error:c.address})]})]}),e.jsxs(p,{children:[e.jsx(x,{children:e.jsxs(v,{className:"flex items-center gap-2 arabic-font",children:[e.jsx(d,{iconNode:ee,className:"h-5 w-5 text-green-600"}),a("invoice-summary")]})}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600 arabic-font",children:a("services-total")}),e.jsxs("span",{className:"font-medium arabic-font",children:[C.toFixed(2)," SAR"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-gray-600 arabic-font",children:[a("vat")," (",S,"%)"]}),e.jsxs("span",{className:"font-medium arabic-font",children:[w.toFixed(2)," SAR"]})]}),e.jsx(X,{}),e.jsxs("div",{className:"flex justify-between items-center text-lg font-bold",children:[e.jsx("span",{className:"arabic-font",children:a("total")}),e.jsxs("span",{className:"text-green-600 arabic-font",children:[O.toFixed(2)," SAR"]})]})]}),t.service.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2 arabic-font",children:a("selected-services")}),e.jsx("div",{className:"space-y-2",children:t.service.map((s,r)=>e.jsxs("div",{className:"flex justify-between items-center p-2 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-sm arabic-font",children:s.service}),e.jsxs("span",{className:"text-sm font-medium arabic-font",children:[s.price.toFixed(2)," SAR"]})]},r))})]})]})]})]}),e.jsxs(p,{children:[e.jsxs(x,{children:[e.jsxs(v,{className:"flex items-center gap-2 arabic-font",children:[e.jsx(d,{iconNode:V,className:"h-5 w-5 text-purple-600"}),a("invoice-details")]}),e.jsx(g,{className:"arabic-font",children:a("invoice-details-description")||"Configure invoice settings and services"})]}),e.jsxs(h,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx(F,{label:a("select-invoice-type"),items:I,titleKey:"type",valueKey:"type",onChange:s=>i("invoice_type",s.target.value),error:c.invoice_type}),e.jsx(F,{label:a("select-payment-type"),items:L,onChange:s=>i("payment_type",s.target.value),titleKey:"title",valueKey:"title",error:c.payment_type}),e.jsx(o,{label:a("invoice-date"),type:"date",value:t.invoice_date,onChange:s=>i("invoice_date",s.target.value),error:c.invoice_date})]}),e.jsx("div",{className:"grid gap-4 md:grid-cols-2",children:e.jsx(o,{label:a("vat-percentage"),type:"number",placeholder:a("vat"),value:t.vat.toString(),onChange:s=>i("vat",Number(s.target.value)),error:c.vat})}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2 arabic-font",children:a("services")}),e.jsxs("div",{className:"relative mb-4",children:[e.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-4 w-4"}),e.jsx(Y,{type:"text",placeholder:a("search-services")||"Search services...",value:u,onChange:s=>P(s.target.value),className:"pl-10 arabic-font"})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:R.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500 arabic-font",children:u?a("no-services-found")||"No services found matching your search":a("no-services-available")||"No services available"}):R.map(s=>{const r=t.service.some(l=>l.service===s.type),n=t.service.find(l=>l.service===s.type);return e.jsxs("div",{className:"border rounded-lg p-3 hover:border-blue-300 transition-colors",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:`service-${s.id}`,checked:r,onChange:l=>{l.target.checked?Q(s.type):U(s.type)},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("label",{htmlFor:`service-${s.id}`,className:"text-sm font-medium text-gray-700 arabic-font cursor-pointer",children:s.type})]})}),r&&e.jsx("div",{className:"mt-2",children:e.jsx(o,{label:a("service-price"),type:"number",placeholder:a("enter-service-price"),value:((n==null?void 0:n.price)||0).toString(),onChange:l=>$(s.type,Number(l.target.value))})})]},s.id)})}),t.service.length>0&&e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(d,{iconNode:ie,className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"text-sm font-medium text-blue-800 arabic-font",children:[a("selected-services-count",{count:t.service.length})," (",t.service.length,")"]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.service.map((s,r)=>e.jsxs(W,{variant:"secondary",className:"arabic-font",children:[s.service,": ",s.price.toFixed(2)," SAR"]},r))})]}),c.service&&e.jsx("p",{className:"mt-1 text-sm text-red-600 arabic-font",children:c.service})]})})]})]}),e.jsxs(p,{children:[e.jsxs(x,{children:[e.jsxs(v,{className:"flex items-center gap-2 arabic-font",children:[e.jsx(d,{iconNode:ce,className:"h-5 w-5 text-orange-600"}),a("additional-details")]}),e.jsx(g,{className:"arabic-font",children:a("additional-details-description")||"Optional vehicle and additional information"})]}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsx(o,{label:a("car_no"),type:"text",placeholder:a("car_no"),value:t.car_no,onChange:s=>i("car_no",s.target.value),error:c.car_no}),e.jsx(o,{label:a("car_type"),type:"text",placeholder:a("car_type"),value:t.car_type,onChange:s=>i("car_type",s.target.value),error:c.car_type}),e.jsx(o,{label:a("percent"),type:"number",placeholder:a("percent"),value:t.percent,onChange:s=>i("percent",s.target.value),error:c.percent})]}),e.jsx(se,{label:a("note"),value:t.note,onChange:s=>i("note",s.target.value),error:c.note})]})]}),e.jsx("div",{className:"flex justify-center pt-6",children:e.jsxs(G,{type:"submit",disabled:y,className:"px-8 py-3 text-lg arabic-font",size:"lg",children:[e.jsx(d,{iconNode:ne,className:"h-5 w-5 mr-2"}),a(y?"saving":"create-invoice")]})})]})}),e.jsx(ae,{modalname:b,message:a("invoice-added-successfully")})]})}export{Be as default};
